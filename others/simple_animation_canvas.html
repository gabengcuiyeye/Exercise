<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"
    />
    <title>eat</title>
  </head>
  <body>
    <canvas id="eat" width="300" height="300"></canvas>
    <script>
      var eat = document.getElementById("eat");
      var ctx = eat.getContext("2d");
      ctx.setLineDash([5, 15]); //画虚线
      ctx.beginPath();
      ctx.moveTo(0, 70);
      ctx.lineTo(220, 70);
      ctx.lineWidth = 2;
      ctx.strokeStyle = "#000";
      ctx.stroke();
      ctx.closePath();

      ctx.rotate((-45 * Math.PI) / 180);

      var i = 10;
      var y = 0;

      setInterval(function () {
        if (i > 0) {
          i--;
          y++;
          run(ctx, i, y);
        }
      }, 1000);

      function run(ctx, i, y) {
        console.log(i);
        ctx.rotate((45 * Math.PI) / 180);
        ctx.globalCompositeOperation = "source-over";
        ctx.clearRect(18 * i, 0, 150, 160);

        //重绘
        ctx.rotate((-45 * Math.PI) / 180);
        ctx.globalCompositeOperation = "destination-over"; //图形组合方式
        ctx.fillStyle = "#fff";
        ctx.beginPath();
        ctx.fillRect(10 * i - 60, 140 - 10.116407864 * y, 60, 60); //计算的不对
        ctx.closePath();
        ctx.fill();
        ctx.closePath();

        ctx.globalCompositeOperation = "destination-over";
        ctx.beginPath();
        ctx.arc(10 * i, 200 - 10.116407864 * y, 60, 0, 2 * Math.PI, true);
        ctx.closePath();
        ctx.fillStyle = "yellow";
        ctx.fill();
      }
    </script>
  </body>
</html>
